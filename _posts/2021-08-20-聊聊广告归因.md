---
layout: post 
title:  "聊聊广告归因"
date:   2021-08-20 08:16:21 +0800 
categories: 广告杂谈
---
### 广告付费类型
要想了解广告归因，我们还得从互联网广告的付费模式聊起。

互联网广告，按照付费类型来划分，可以分为以下几种：
1. CPD：按天付费
2. CPM：按曝光数付费
3. CPC：按点击数付费
4. CPI：按安装数付费
5. CPA：按安装后的事件付费，如：注册数、购买数

我们下面来简单分析下，每种付费类型下，广告主和媒体方就付费这一环节，会出现什么问题。

**CPD广告**

这种付费模式很简单，广告主选定好流量定向条件后，符合这个流量条件的所有人群，在广告主付费的时间段，看到的广告必须只能是这个广告主的广告。
这种模式下，广告主想要验证媒体方是否把全部流量都给了自己的广告其实很简单，因为不涉及到竞价、控量这些逻辑，所以当去查看时，
任何时候曝光的都应该是这个广告主的广告。所以这种付费模式，在不需要第三方介入的情况下，广告主和媒体方就能达成一致。

**CPM广告**

这种付费模式相比CPD要稍稍复杂，因为曝光这个动作，完全是媒体方的行为。如果完全按照媒体方提供的曝光数据进行付费，广告主难免会产生不信任感。
因为此时媒体方既是选手，又是裁判。这就产生了第三方监测平台，用来帮媒体方计数。一般的方式是通过在广告曝光时，触发监测平台提供的监测链接，
来把曝光这一事件同步给监测平台。监测平台是有反作弊功能的，所以媒体方是造假的。广告主付费时，一般都是根据监测平台的数据来进行付费。

**CPC广告**

玩法和CPM广告是一样的，一般也需要第三方监测平台来监测点击数，并最终提供数据给广告主。

**CPI广告**

这种付费方式又要更加复杂一点，因为安装这个动作，是媒体方无法模拟的，并且他也是无法知道的。广告主可以知道自己的APP的安装数，
但他可能同时在多个媒体渠道投广告，那么每个媒体渠道带来的安装数量它是无法知道的。所以仅凭媒体方和广告主，是无法就付费达成一致的。
这时，就需要第三方归因平台的介入了。归因平台可以提供，每家媒体渠道给广告主的APP分别带来了多少新用户安装、老用户找回、不活跃用户唤醒，
以及后续的各种用户行为事件。

**CPA广告**

玩法和CPI广告一样，也需要归因平台介入。

### 广告归因
上面我们给出了一个结论，就是CPI、CPA类的广告，需要归因平台的介入，广告主才能够获知，每家流量渠道给自己的APP带来了多少安装或事件。
那么到底什么是归因呢？归因是如何做的呢？下面我们来详细的介绍，为了简单，我们就只以CPI广告为例，CPA的道理是一样的。

#### 什么是归因
归因就是把一个安装事件，归功于某个媒体渠道。

#### 为什么需要归因
其实上面已经回答了这个问题了，没有归因的话，广告主就无法知道自己APP的安装数，分别是哪些渠道带来的，这样就无法和媒体方进行结算，
也无法让广告主进行精细化投放。

#### 归因是如何做的
广告的点击都是在媒体方完成的，但是安装和激活却不是，安装一般是在应用商店，而激活是指第一次打开APP，那只有广告主才知道。
所以归因平台做的事情其实是：将广告主上报的安装激活事件，与媒体方上报的点击事件进行匹配，如果能匹配上，那这个安装就是这家媒体带来的。
如果匹配不上，那这个安装就被认为是自然量。

**安装激活如何上报**

归因平台会对外提供一个接口，供广告主用来上报各种事件。一般的，归因平台都会提供一个SDK，广告主直接在自己的APP里嵌入这个SDK即可，
这样广告主就不需要进行额外的开发了。

**点击如何上报**

同样还是通过接口的方式，不过这次归因平台是没有提供SDK的，而是提供了一条归因链接，这个链接里有一些归因逻辑需要的参数，如gaid、
idfa、click_id等等。初次之外，归因链接上还会带有广告主、媒体方的信息，如media_source。

**媒体方如何知道自己被归因了？**

媒体方训练cvr模型、报表展示，都需要这个信息。因此，媒体方会提供一个接口，当归因平台把安装归因给这家媒体时，会调用这个回传接口，
把归因回传给媒体方。那么媒体方如何知道这个归因是对应的是之前上报的哪一个点击呢？这时就需要一个参数了：click_id。click_id一般是个uuid，
用来标记一次点击。媒体方给归因平台发点击时，一般都要带上一个click_id参数，归因平台回传时也会把click_id传回来，通过click_id的匹配，
媒体方就能知道归因对应的是哪个点击了，进而知道所有的信息。

**归因平台如何归因**

上面提到了，归因就是归因平台把广告主上报的安装和媒体方上报的点击进行匹配，那么如何匹配呢？一般都有两种方式：
1. 如果上报信息中有gaid，那么就会触发强匹配，即通过安装上报的gaid，把处在归因窗口期内的、携带相同gaid的点击捞出来，进行匹配。
如果只有一个点击，那自然而然的就是它了；如果有多个，一般是遵循last click，即最后一次点击的匹配原则，选择离安装最近的那个点击进行归因。
2. 如果上报信息中没有类似于gaid这种的用户唯一标识，那么就会触发若匹配，通过ip、ua等信息，进行匹配。若匹配也会遵循last click原则。

**好像媒体方仍然可以作弊？**

这里列出常见的两种作弊方式：

_作弊方式一_

媒体方通过写脚本，不停地模拟用户发点击，上报给归因平台，通过大点击的方式，提高自己的归因率。这种作弊方式其实是最原始的一种方式，
归因平台很容易识别出来这种方式。因为大点击这种作弊，媒体方的CVR一定是非常低的，当CVR非常低时，归因平台就有理由认为，这是作弊流量，
从而不会再把归因归给你了。

_作弊方式二_

基于安卓系统的广播机制，当用户安装一个新的APP时，设备上已安装的APP都能通过广播机制获取到新APP安装的信息，这时，媒体方可以通过发一个假的点击的方式，
来争取这次归因的机会。这种作弊方式叫做：点击劫持。点击劫持一般是通过安装时间和点击时间来进行反作弊的，如果点击时间晚于安装时间，
那就会被认为是作弊点击

**用户没有点击，会归因吗**

用户看了媒体方的广告，但是没有点击该广告。后面再安装了广告主的APP后，媒体方仍然可能会得到归因。这需要：
1. 广告主认可由曝光带来的安装，这一般是个配置，广告主可以在归因平台上选择开启或关闭
2. 用户在观看了这个广告后，在安装APP之前，没有在其他的媒体上观看或点击该广告主的广告